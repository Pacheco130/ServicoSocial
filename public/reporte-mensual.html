<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Reporte Mensual</title>
    <link rel="stylesheet" href="reporte-mensual.css">
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const fase1 = document.getElementById('fase1');
            const fase2 = document.getElementById('fase2');
            const siguienteBtn = document.getElementById('siguienteBtn');
            fase2.style.display = 'none';
            siguienteBtn.addEventListener('click', function (e) {
                e.preventDefault();
                fase1.style.display = 'none';
                fase2.style.display = 'block';
            });

            // Restricción de fecha según reporte
            const periodos = [
                { fin: '2025-11-15' },
                { fin: '2025-12-15' },
                { fin: '2026-01-15' },
                { fin: '2026-02-15' },
                { fin: '2026-03-15' },
                { fin: '2026-04-15' },
                { fin: '2026-05-14' }
            ];
            const nreporte = document.getElementById('nreporte');
            const fecha = document.getElementById('fecha');
            nreporte.addEventListener('change', function () {
                const idx = parseInt(nreporte.value) - 1;
                if (idx >= 0 && periodos[idx]) {
                    let fin = new Date(periodos[idx].fin);
                    let diasHabiles = [];
                    let count = 0;
                    let d = new Date(fin);
                    d.setDate(d.getDate() + 1); // Empieza al día siguiente
                    while (diasHabiles.length < 5) {
                        if (d.getDay() !== 0 && d.getDay() !== 6) { // 0=Domingo, 6=Sábado
                            diasHabiles.push(new Date(d));
                        }
                        d.setDate(d.getDate() + 1);
                    }
                    const min = diasHabiles[0].toISOString().slice(0,10);
                    const max = diasHabiles[4].toISOString().slice(0,10);
                    fecha.min = min;
                    fecha.max = max;
                    fecha.value = min;
                } else {
                    fecha.min = '';
                    fecha.max = '';
                    fecha.value = '';
                }
            });

            fecha.addEventListener('input', function () {
                const d = new Date(fecha.value);
                if (d.getDay() === 0 || d.getDay() === 6) {
                    alert('No puedes seleccionar sábado ni domingo.');
                    fecha.value = '';
                }
            });
        });
    </script>
</head>
<body>
    <header>
        <h1>Reporte Mensual</h1>
        <img src="/img/CECyt19.png" alt="Logo Izquierdo" class="corner-image left">
        <img src="/img/IPN.png" alt="Logo Derecho" class="corner-image right">
    </header>
    <div class="form-container">
        <form id="reporteForm" method="POST" action="/generate-reporte-mensual">
            <div id="fase1">
                <div class="form-flex">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="nreporte">N. Reporte:</label>
                            <select id="nreporte" name="nreporte" required>
                                <option value="">Seleccione...</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="nombreA">Nombre:</label>
                            <input type="text" id="nombreA" name="nombreA" required>
                        </div>
                        <div class="form-group">
                            <label for="boleta">Boleta:</label>
                            <input type="text" id="boleta" name="boleta" required>
                        </div>
                        <div class="form-group">
                            <label for="telefono">Teléfono:</label>
                            <input type="tel" id="telefono" name="telefono" required>
                        </div>
                        <div class="form-group">
                            <label for="prestatario">Prestatario:</label>
                            <input type="text" id="prestatario" name="prestatario" required>
                        </div>
                        <div class="form-group">
                            <label for="encargadoDirecto">Encargado Directo:</label>
                            <input type="text" id="encargadoDirecto" name="encargadoDirecto" required>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="nregistro">N. Registro:</label>
                            <input type="text" id="nregistro" name="nregistro" required>
                        </div>
                        <div class="form-group">
                            <label for="carrera">Carrera:</label>
                            <select id="carrera" name="carrera" required>
                                <option value="">Seleccione...</option>
                                <option value="Tecnico en Aeronáutica">Técnico en Aeronáutica</option>
                                <option value="Tecnico en Alimentos">Técnico en Alimentos</option>
                                <option value="Tecnico en Construccion">Técnico en Construcción</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="semestre">Semestre:</label>
                            <select id="semestre" name="semestre" required>
                                <option value="">Seleccione...</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="fecha">Fecha:</label>
                            <input type="date" id="fecha" name="fecha" required>
                        </div>
                        <div class="form-group">
                            <label for="correo">Correo:</label>
                            <input type="email" id="correo" name="correo" required>
                        </div>
                        <div class="form-group">
                            <label for="cargo">Cargo:</label>
                            <input type="text" id="cargo" name="cargo" required>
                        </div>
                    </div>
                </div>
                <button id="siguienteBtn">Siguiente</button>
            </div>
            <div id="fase2">
                <div class="form-group">
                    <label>Actividades:</label>
                    <div class="actividades-group">
                        <input type="text" name="actividad1" id="actividad1" placeholder="Actividad 1" required>
                        <input type="text" name="actividad2" id="actividad2" placeholder="Actividad 2" required>
                        <input type="text" name="actividad3" id="actividad3" placeholder="Actividad 3" required>
                        <input type="text" name="actividad4" id="actividad4" placeholder="Actividad 4" required>
                        <input type="text" name="actividad5" id="actividad5" placeholder="Actividad 5" required>
                        <input type="text" name="actividad6" id="actividad6" placeholder="Actividad 6" required>
                        <input type="text" name="actividad7" id="actividad7" placeholder="Actividad 7" required>
                    </div>
                </div>
                <button type="submit">Descargar Reporte</button>
            </div>
        </form>
    </div>
    <script src="reporte-mensual.js"></script>
    <script src="script.js"></script>
</body>
</html>